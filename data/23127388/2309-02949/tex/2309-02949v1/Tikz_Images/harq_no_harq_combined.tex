\definecolor{bblue}{HTML}{4F81BD}
\definecolor{rred}{HTML}{C0504D}
\definecolor{ggreen}{HTML}{9BBB59}
\pgfplotsset{
    legend image with text/.style={
        legend image code/.code={%
            \node[anchor=center] at (0.3cm,0cm) {#1};
        }
    },
}
\begin{tikzpicture}
    \begin{axis}[
        width  = \textwidth,
        height = 4cm,
        major x tick style = transparent,
        ybar,
        %ybar=2*\pgflinewidth,
        bar width=18pt,
        ymajorgrids = true,
        ylabel = {PRR},
        ylabel style={yshift=0.1cm},
        xlabel = {\# of UEs},
        symbolic x coords={4, 6, 8},
        nodes near coords,
        nodes near coords style={fill opacity=1.0,font=\tiny, /pgf/number format/.cd,precision=5},
        %every node near coord/.append style={font=\small},
        xtick = data,
        scaled y ticks = true,
        axis y line*=left,
        axis x line*=bottom,
        enlarge x limits=0.25,
        y tick label style={ /pgf/number format/.cd, fixed, fixed zerofill, precision=4},
        %ymin=0,
        legend columns=3,
        legend cell align=left,
        legend style={
                at={(0.75,-0.25)},
                anchor=north,
                column sep=5pt,
                fill opacity=0.8,
                draw opacity=1,
                text opacity=1,
                draw=white!80!black
        },
        legend image code/.code={
        \draw [#1] (0cm,-0.1cm) rectangle (0.35cm,0.15cm); }
    ]
    \addlegendimage{legend image with text=no HARQ (HD)}
    \addlegendentry{}
    \addlegendimage{legend image with text=HARQ}
    \addlegendentry{}
     \addlegendimage{legend image with text=FD}
    \addlegendentry{}
    
        \addplot[style={rred,fill=rred, fill opacity=0.2, mark=none, text=red}]
            coordinates {(4, 0.999831) (6, 0.997122) (8, 0.996777)};\addlegendentry{}

        \addplot[style={ggreen,fill=ggreen, fill opacity=0.2, mark=none, text=teal}, nodes near coords=\raisebox{0.1cm}{\pgfmathprintnumber\pgfplotspointmeta}]
             coordinates {(4,0.999986) (6,0.99954) (8,0.9997)};\addlegendentry{}

        \addplot[style={bblue,fill=bblue, fill opacity=0.2, mark=none, text=blue}]
             coordinates {(4,0.999918) (6,0.999483) (8,0.998763)};\addlegendentry{3ms}

         \addplot[style={rred,fill=rred, fill opacity=0.2, mark=none, text=red},postaction={pattern=north east lines, fill opacity=0.5}]
            coordinates {(4, 0.9976) (6, 0.9970) (8, 0.9878)};\addlegendentry{}

        \addplot[style={ggreen,fill=ggreen, fill opacity=0.2, mark=none, text=teal},postaction={pattern=north east lines, fill opacity=0.5},
        nodes near coords=\raisebox{0.12cm}{\pgfmathprintnumber\pgfplotspointmeta}]
             coordinates {(4,0.9977) (6,0.9912) (8,0.9820)};\addlegendentry{}

        \addplot[style={bblue,fill=bblue, fill opacity=0.2, mark=none, text=blue},postaction={pattern=north east lines, fill opacity=0.5}]
             coordinates {(4,0.9997) (6,0.9980) (8,0.9954)};\addlegendentry{10ms}

        %\legend{no HARQ (HD),HARQ,FD, no HARQ (HD),HARQ,FD}
        
    \end{axis}


\end{tikzpicture}
